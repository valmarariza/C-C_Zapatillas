
{% extends "base.html" %}
{% block title %}Admin - Productos{% endblock %}
{% block content %}
<div class="row">
  <div class="col-lg-5">
    <h2 class="h5">Crear producto</h2>
    <form method="post" action="{{ url_for('admin.products_create') }}">
      <div class="mb-2"><label class="form-label">Nombre</label><input class="form-control" name="name" required></div>
      <div class="mb-2"><label class="form-label">Descripción</label><textarea class="form-control" name="description"></textarea></div>
      <div class="mb-2"><label class="form-label">Precio</label><input class="form-control" type="number" name="price" step="0.01" required></div>
      <div class="mb-2"><label class="form-label">Stock</label><input class="form-control" type="number" name="stock" required value="0"></div>
      <div class="mb-2"><label class="form-label">Imagen URL</label><input class="form-control" name="image_url"></div>
      <div class="mb-3">
        <label class="form-label">Categoría</label>
        <select class="form-select" name="category_id">
          <option value="">--</option>
          {% for c in categories %}<option value="{{ c.id }}">{{ c.name }}</option>{% endfor %}
        </select>
      </div>
      <button class="btn btn-primary" type="submit">Crear</button>
    </form>
  </div>
  <div class="col-lg-7">
    <h2 class="h5">Listado</h2>
    <div class="table-responsive">
    <table class="table table-sm align-middle">
      <thead><tr><th>#</th><th>Nombre</th><th>Precio</th><th>Stock</th><th>Cat</th><th>Editar</th><th>Eliminar</th></tr></thead>
      <tbody>
      {% for p in products %}
      <tr>
        <td>{{ p.id }}</td>
        <td>{{ p.name }}</td>
        <td>${{ '%.0f'|format(p.price) }}</td>
        <td>{{ p.stock }}</td>
        <td>{{ p.category.name if p.category else '' }}</td>
        <td>
          <form class="row g-1" method="post" action="{{ url_for('admin.products_update', pid=p.id) }}">
            <div class="col-12 col-md-6"><input class="form-control form-control-sm" name="name" value="{{ p.name }}"></div>
            <div class="col-12"><input class="form-control form-control-sm" name="description" value="{{ p.description }}"></div>
            <div class="col-6 col-md-3"><input class="form-control form-control-sm" name="price" type="number" step="0.01" value="{{ p.price }}"></div>
            <div class="col-6 col-md-2"><input class="form-control form-control-sm" name="stock" type="number" value="{{ p.stock }}"></div>
            <div class="col-12"><input class="form-control form-control-sm" name="image_url" value="{{ p.image_url or '' }}"></div>
            <div class="col-8">
              <select class="form-select form-select-sm" name="category_id">
                <option value="">--</option>
                {% for c in categories %}
                  <option value="{{ c.id }}" {% if p.category_id==c.id %}selected{% endif %}>{{ c.name }}</option>
                {% endfor %}
              </select>
            </div>
            <div class="col-4"><button class="btn btn-outline-secondary btn-sm w-100" type="submit">Guardar</button></div>
          </form>
        </td>
        <td>
          <form method="post" action="{{ url_for('admin.products_delete', pid=p.id) }}">
            <button class="btn btn-outline-danger btn-sm" type="submit">Eliminar</button>
          </form>
        </td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
    </div>
  </div>
</div>
{% endblock %}
